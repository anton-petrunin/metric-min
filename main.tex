\section{Proof assembling}\label{Main theorem}



\parit{Proof of the main theorem.}
It is sufficient to consider
the case that $|\DD|_s$ is  homeomorphic to a disc.
Indeed, it is sufficient to show that a triangle $[xyz]$ in $\<\DD\>_s$ is thin. 
Once the above case has been proven, the closure of each connected open component of $\<\DD\>_s\backslash ([x,y]\cup[y,z]\cup[z,x])$
surrounded by the triangle is $\CAT(0)$.
From this, the thinness of the triangle $[xyz]$ follows; see \cite{bishop}.

Given a finite set $F\subset \DD$,
denote by $\mathcal{W}_F$
the set of isometry classes of spaces $W$ which meet the conditions of the key lemma~\ref{lem:key}
for $F$;
according to the key lemma, $\mathcal{W}_F\ne\emptyset$.
Note that for two finite sets $F\subset F'$ in $\DD$,
we have $\mathcal{W}_F\supset \mathcal{W}_{F'}$.

According to the compactness Lemma (\ref{lem:compact}) $\mathcal{W}_F$ is compact.
Therefore 
\[\mathcal{W}
=
\bigcap_{F}\mathcal{W}_F\ne \emptyset\]
where the intersection is taken over all finite subsets $F$ in $\DD$. 


Fix a space $W$ from $\mathcal{W}$;
the space $W$ is a $\CAT(0)$ disc retract,
such that given a finite set $F\subset \DD$ there is a map $h_F\:F\to W$ which is short with 
respect to $\<{*}-{*}\>_s$ 
and a short map $q_F\:W\to Y$ such that $q_F\circ h_F$ agrees with $s$ on $\partial\DD\cap F$.

Given a finite set $F\subset \DD$,
denote by $\mathfrak{S}_F$ the set of all maps $h_F\:F\to W$ described above.

By Lemma \ref{lem:S-closed}, $\mathfrak{S}_F$ is closed.
The condition on the restriction of $h_F\in  \mathfrak{S}_F$ in the extension lemma (\ref{lem:finite-whole}) is evident.
That is, $\mathfrak{S}_F$ satisfies the assumption of the lemma.

Applying the extension lemma (\ref{lem:finite-whole}),
we get a map $h\:\DD\to W$ such that $h|_F\in \mathfrak{S}_F$
for any finite set $F\subset \DD$.

Our next aim is to show that there is a single map $q$ such that
for all finite sets $F$ the composition $q\circ h|_F$ agrees with
$s$ on $\partial\DD\cap F$.
This is done by applying the ultralimit+projection construction.

Choose a sequence of finite sets $F_n$ such that the intersections $F_n\cap\partial \DD$ get denser and denser in $\partial \DD$, 
denote by $q_n$ the corresponding maps.
Let $q_\omega\:W\to Y^\omega$ be the ultralimit of $q_n$ and set $q=\nu\circ q_\omega$,
where $\nu\:Y^\omega\to Y$ is the nearest point projection.
By construction $q\:W\to Y$ is short and $q\circ h$ agrees with $s$ on $\partial \DD$.
Note that we can't quite conclude $s\succcurlyeq q\circ h$ because $h$ might not be continuous.

By construction, the map $h$ induces a short map $\hat h\:\<\DD\>_s\to W$ 
such that $\hat h\circ\delta_s$ is the boundary curve of $W$.
By Lemma \ref{lem:maj is isom}, $\hat h$ is an isometry and the statement follows.
\qeds